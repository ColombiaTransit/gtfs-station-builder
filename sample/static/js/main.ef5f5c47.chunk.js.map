{"version":3,"sources":["interfaces/Stop.tsx","interfaces/Pathway.tsx","services/VisService.tsx","components/Vis.tsx","components/StopDialog.tsx","components/PathwayDialog.tsx","components/StationBuilder.tsx","services/DataService.tsx","App.tsx","index.js","images/wheelchair-accessible.png","images/wheelchair-not-possible.png"],"names":["LocationTypeMap","Platform","Station","Entrance/Exit","GenericNode","BoardingArea","LocationTypeOnNodeLabelMap","WheelchairBoardingMap","NoInfo","Accessible","NotPossible","LocationTypeColors","LocationTypeSort","PathwayModeMap","Walkway","Stairs","MovingSidewalk","Escalator","Lift","FareGate","ExitGate","PathwayModeOnEdgeLabelMap","PathwayModeColors","VisService","stop","prefix","locationType","label","stopName","platformCode","signpostedAs","pathway","pathwayMode","traversalTime","x","y","id","stopId","getNodeLabel","color","image","wheelchairBoarding","wheelchairAccessibleImage","wheelchairNotPossibleImage","shape","size","node","includes","this","newStopId","pathwayId","from","fromStopId","to","toStopId","highlight","arrows","isBidirectional","font","align","getEdgeLabel","edge","newPathwayId","length","undefined","stairCount","maxSlope","minWidth","reversedSignpostedAs","Vis","_this","container","document","getElementById","clientWidth","clientHeight","levelsX","nodes","props","data","stops","map","graphLevel","convertStopToNode","edges","pathways","convertPathwayToEdge","options","borderWidth","selectionWidth","manipulation","enabled","initiallyActive","addNode","onStopAdd","editNode","onStopEdit","deleteNode","dataToDelete","callback","network","getConnectedEdges","onStopDelete","addEdge","onPathwayAdd","editEdge","editWithoutDrag","body","get","onPathwayEdit","deleteEdge","onPathwayDelete","interaction","dragView","hoverConnectedEdges","selectConnectedEdges","zoomView","physics","barnesHut","avoidOverlap","gravitationalConstant","centralGravity","springConstant","damping","springLength","maxVelocity","locales","gtfs","edit","del","back","addDescription","edgeDescription","editEdgeDescription","createEdgeError","deleteClusterError","editClusterError","locale","vis","Network","on","selection","getSelection","editEdgeMode","react_default","a","createElement","Component","StopDialog","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","handleCancel","onCancel","handleApply","state","onApply","objectSpread","alert","handleLocationTypeChange","event","setState","Number","target","value","handleWheelchairBoardingChange","handleStopNameChange","handlePlatformCodeChange","handleSignpostedAsChange","locationTypeOptions","push","key","wheelchairBoardingOptions","wheelchairBoardingKey","className","onChange","type","onClick","PathwayDialog","parseFloat","handlePathwayModeChange","handleIsBidirectionalChange","checked","handleLengthChange","replace","handleTraversalTimeChange","parseInt","handleStairCountChange","handleMaxSlopeChange","handleMinWidthChange","handleReversedSignpostedAsChange","toString","pathwayModeOptions","pathwayModeKey","StationBuilder","stationId","handleStopAddMode","prepareNewNode","selectedStop","handleStopEditMode","handlePathwayAddMode","prepareNewEdge","selectedPathway","handlePathwayEditMode","handleStopDialogApply","stopIndex","findIndex","curStop","attachStopToNode","handlePathwayDialogApply","pathwayIndex","curPathway","attachPathwayToEdge","handleItemDelete","forEach","nodeId","splice","handleDialogCancel","handleSaveClick","onSave","cloneDeep","Error","Vis_Vis","StopDialog_StopDialog","PathwayDialog_PathwayDialog","DataService","recordFromGTFS","rows","split","records","header","row","cells","cell","cellIndex","recordGTFS","fieldName","levelId","escapeText","level","levelName","levelIndex","text","App","handleFileChange","files","requiredFiles","requiredFilesCount","communicationPacket","levels","zipFile","JSZip","loadAsync","then","zip","relativePath","file","indexOf","name","async","fileContent","extractData","editMode","join","e","console","log","message","Array","fileReader","FileReader","onload","result","readAsText","saveStation","stopsTxt","getStopGTFSHeader","pathwaysTxt","getPathwayGTFSHeader","levelsTxt","getLevelGTFSHeader","stopToGTFS","pathwayToGTFS","levelToGTFS","generateAsync","blob","saveAs","loadSampleData","fileName","fromGTFS","stopFromGTFS","pathwayFromGTFS","levelFromGTFS","multiple","StationBuilder_StationBuilder","ReactDOM","render","App_App","module","exports"],"mappings":"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","file":"static/js/main.ef5f5c47.chunk.js","sourcesContent":["export default interface Stop {\n    stopId: number;\n    stopName?: string;\n    locationType: number;\n    wheelchairBoarding: number;\n    levelId?: number;\n    platformCode?: string;\n    signpostedAs?: string;\n}\n\nexport const LocationTypeMap: { [key: string]: number } = {\n    \"Platform\": 0,\n    \"Station\": 1,\n    \"Entrance/Exit\": 2,\n    \"GenericNode\": 3,\n    \"BoardingArea\": 4\n}\n\nexport const LocationTypeOnNodeLabelMap = [\n    \"Platform\",\n    \"Station\",\n    \"E/E\",\n    \"GN\",\n    \"BA\"\n]\n\nexport const WheelchairBoardingMap: { [key: string]: number } = {\n    \"NoInfo\": 0,\n    \"Accessible\": 1,\n    \"NotPossible\": 2\n}\n\nexport const LocationTypeColors = [\n    \"#6898ee\",\n    \"#333333\",\n    \"#f2565c\",\n    \"#999999\",\n    \"#7ecb7d\"\n]\n\nexport const LocationTypeSort = [\n    3, 0, 1, 2, 4\n]\n","export default interface Pathway {\n    pathwayId: number;\n    fromStopId: number;\n    toStopId: number;\n    pathwayMode: number;\n    isBidirectional: boolean;\n    length?: number;\n    traversalTime?: number;\n    stairCount?: number;\n    maxSlope?: number;\n    minWidth?: number;\n    signpostedAs?: string;\n    reversedSignpostedAs?: string;\n}\n\nexport const PathwayModeMap: { [key: string]: number } = {\n    \"Walkway\": 1,\n    \"Stairs\": 2,\n    \"MovingSidewalk\": 3,\n    \"Escalator\": 4,\n    \"Lift\": 5,\n    \"FareGate\": 6,\n    \"ExitGate\": 7\n}\n\nexport const PathwayModeOnEdgeLabelMap = [\n    \"\",\n    \"Walkway\", // pathway modes begin from 1\n    \"Stairs\",\n    \"MovingSidewalk\",\n    \"Escalator\",\n    \"Lift\",\n    \"FareGate\",\n    \"ExitGate\"\n]\n\nexport const PathwayModeColors = [\n    \"\",\n    \"#000000\", // pathway modes begin from 1\n    \"#6898ee\",\n    \"#888888\",\n    \"#7ecb7d\",\n    \"#f38e1a\",\n    \"#9772c4\",\n    \"#f2565c\"\n]\n","import Stop, { LocationTypeOnNodeLabelMap, LocationTypeColors, WheelchairBoardingMap, LocationTypeMap } from \"../interfaces/Stop\";\nimport Pathway, { PathwayModeOnEdgeLabelMap, PathwayModeColors, PathwayModeMap } from \"../interfaces/Pathway\";\nimport VisNode from \"../interfaces/VisNode\";\nimport VisEdge from \"../interfaces/VisEdge\";\nimport wheelchairAccessibleImage from '../images/wheelchair-accessible.png';\nimport wheelchairNotPossibleImage from '../images/wheelchair-not-possible.png';\n\n// This service defines how to draw things\n//   and take care of stop-node and pathway-edge convertion\nexport default class VisService {\n\tstatic newStopId = -1;\n\tstatic newPathwayId = -1;\n\n    static getNodeLabel(stop: Stop): string {\n        let prefix = LocationTypeOnNodeLabelMap[stop.locationType];\n        let label =  stop.stopName ? prefix + ' \"' + stop.stopName + '\"' : prefix;\n        if (stop.locationType === 0) { // Platform\n            if (stop.platformCode) {\n                label += '\\nCode: \"' + stop.platformCode + '\"';\n            }\n            if (stop.signpostedAs) {\n                label += '\\nSignposted: \"' + stop.signpostedAs + '\"';\n            }\n\t\t}\n\t\telse if (stop.locationType === 2) { // Entrance/Exit\n\t\t\tif (stop.platformCode) {\n                label += '\\nNumber: \"' + stop.platformCode + '\"';\n            }\n\t\t}\n        return label;\n    }\n\n    static getEdgeLabel(pathway: Pathway): string {\n        let prefix = PathwayModeOnEdgeLabelMap[pathway.pathwayMode];\n        let label = prefix;\n        if (pathway.traversalTime) {\n            label += '\\n' + pathway.traversalTime + ' s'\n        }\n        return label;\n\t}\n\n\tstatic convertStopToNode(stop: Stop, x: number, y: number): VisNode {\n        return {\n            id: stop.stopId,\n            label: VisService.getNodeLabel(stop),\n            color: LocationTypeColors[stop.locationType],\n            x: x,\n            y: y,\n            image: stop.wheelchairBoarding === 1 ? wheelchairAccessibleImage : stop.wheelchairBoarding === 2 ? wheelchairNotPossibleImage : \"\",\n            shape: 'circularImage',\n            size: 12,\n            stop: stop\n        }\n    }\n\n    static attachStopToNode(stop: Stop, node: VisNode): VisNode {\n        if ([3, 4].includes(stop.locationType)) {\n            stop.wheelchairBoarding = WheelchairBoardingMap.NoInfo;\n        }\n        node.label = VisService.getNodeLabel(stop);\n        node.color = LocationTypeColors[stop.locationType];\n        node.shape = 'circularImage';\n        node.size = 12;\n        node.image = stop.wheelchairBoarding === 1 ? wheelchairAccessibleImage : stop.wheelchairBoarding === 2 ? wheelchairNotPossibleImage : \"\";\n        node.stop = stop;\n        return node;\n    }\n\n    static prepareNewNode(node: VisNode): VisNode {\n\t\tnode.id = this.newStopId;\n        node.label = \"\";\n        node.color = LocationTypeColors[LocationTypeMap.GenericNode];\n        node.shape = 'circularImage';\n        node.size = 12;\n        node.stop = {\n            stopId: this.newStopId,\n            stopName: \"\",\n            locationType: LocationTypeMap.GenericNode,\n            wheelchairBoarding: WheelchairBoardingMap.NoInfo,\n            platformCode: \"\",\n            signpostedAs: \"\"\n\t\t};\n\t\tthis.newStopId--;\n        return node;\n    }\n\n    static convertPathwayToEdge(pathway: Pathway): VisEdge {\n        return {\n            id: pathway.pathwayId,\n            from: pathway.fromStopId,\n            to: pathway.toStopId,\n            color: {\n                color: PathwayModeColors[pathway.pathwayMode],\n                highlight: PathwayModeColors[pathway.pathwayMode]\n            },\n            arrows: {\n                from: pathway.isBidirectional,\n                to: true\n            },\n            font: {\n                align: 'center'\n            },\n            label: VisService.getEdgeLabel(pathway),\n            pathway: pathway\n        };\n    }\n\n    static attachPathwayToEdge(pathway: Pathway, edge: VisEdge): VisEdge {\n        edge.color.color = PathwayModeColors[pathway.pathwayMode];\n        edge.color.highlight = PathwayModeColors[pathway.pathwayMode];\n        edge.arrows.from = pathway.isBidirectional;\n        edge.label = VisService.getEdgeLabel(pathway);\n        edge.pathway = pathway;\n        return edge;\n    }\n\n    static prepareNewEdge(edge: VisEdge): VisEdge {\n\t\tedge.id = this.newPathwayId;\n        edge.color = {\n            color: PathwayModeColors[PathwayModeMap.Escalator],\n            highlight: PathwayModeColors[PathwayModeMap.Escalator]\n        }\n        edge.arrows = {\n            from: true,\n            to: true\n        };\n        edge.font = {\n            align: 'center'\n        };\n        edge.label = '';\n        edge.pathway = {\n            pathwayId: this.newPathwayId,\n            fromStopId: edge.from,\n            toStopId: edge.to,\n            pathwayMode: PathwayModeMap.Escalator,\n            isBidirectional: true,\n            length: undefined,\n            traversalTime: undefined,\n            stairCount: undefined,\n            maxSlope: undefined,\n            minWidth: undefined,\n            signpostedAs: \"\",\n            reversedSignpostedAs: \"\"\n\t\t}\n\t\tthis.newPathwayId--;\n        return edge;\n    }\n}\n","import React, { Component } from 'react';\nimport vis from 'vis';\nimport 'vis/dist/vis-network.min.css';\nimport './Vis.scss';\nimport Stop, { LocationTypeSort } from '../interfaces/Stop';\nimport VisNode from '../interfaces/VisNode';\nimport VisService from '../services/VisService';\nimport VisEdge from '../interfaces/VisEdge';\nimport Communication from '../interfaces/Communication';\nimport Pathway from '../interfaces/Pathway';\n\nexport interface VisState {\n  \n}\n\nexport interface VisProps {\n  data: Communication,\n  onStopAdd: (node: VisNode, callback: (node?: VisNode) => void) => void,\n  onStopEdit: (node: VisNode, callback: (node?: VisNode) => void) => void,\n  onStopDelete: (dataToDelete: { nodes: number[], edges: number[] }, callback: (dataToDelete?: { nodes: number[], edges: number[] }) => void) => void,\n  onPathwayAdd: (edge: VisEdge, callback: (edge?: VisEdge) => void) => void,\n  onPathwayEdit: (edge: VisEdge, callback: (edge?: VisEdge) => void) => void,\n  onPathwayDelete: (dataToDelete: { nodes: number[], edges: number[] }, callback: (dataToDelete?: { nodes: number[], edges: number[] }) => void) => void,\n}\n\nexport default class Vis extends Component<VisProps, VisState> {\n  componentDidMount() {\n    var container = document.getElementById('vis');\n    if (!container) {\n      return;\n    }\n    \n    let x = - container.clientWidth / 2;\n    let y = - container.clientHeight / 2;\n    const stepX = 200;\n    const stepY = 100;\n    let levelsX: { [key: string]: number }  = {};\n\n    // get nodes from stops\n\tconst nodes: VisNode[] = this.props.data.stops.map((stop: Stop): VisNode => {\n\t\tlet graphLevel = LocationTypeSort[stop.locationType];\n\t\tif (!levelsX[graphLevel]) {\n\t\t\tlevelsX[graphLevel] = x - stepX;\n\t\t}\n\t\tlevelsX[graphLevel] += stepX;\n\t\tconst node = VisService.convertStopToNode(stop, levelsX[graphLevel], y + LocationTypeSort[stop.locationType] * stepY);\n\t\treturn node;\n\t});\n\n\t// get edges from pathways\n\tconst edges: VisEdge[] = this.props.data.pathways.map((pathway: Pathway): VisEdge => {\n\t\tconst edge = VisService.convertPathwayToEdge(pathway);\n\t\treturn edge;\n\t});\n\n    // configure vis\n    var options = {\n        nodes: {\n          borderWidth: 2\n        },\n        edges: {\n          selectionWidth: 2\n        },\n        manipulation: {\n          enabled: true,\n          initiallyActive: true,\n          addNode: this.props.onStopAdd,\n          editNode: this.props.onStopEdit,\n          deleteNode: (dataToDelete: { nodes: number[], edges: number[] }, callback: (dataToDelete?: { nodes: number[], edges: number[] }) => void): void => {\n\t\t\tdataToDelete.edges = network.getConnectedEdges(dataToDelete.nodes[0]);\n\t\t\tthis.props.onStopDelete(dataToDelete, callback);\n\t\t  },\n          addEdge: this.props.onPathwayAdd,\n          editEdge:  {\n            editWithoutDrag: (edge: VisEdge, callback: (edge?: VisEdge) => void) => {\n              // Get edge from DataSets because from params we can't get attached information\n              let edgesDataSet = network.body.data.edges;\n              edge = edgesDataSet.get(edge.id);\n              this.props.onPathwayEdit(edge, callback);\n            }\n          },\n          deleteEdge: this.props.onPathwayDelete\n        },\n        interaction: {\n          dragView: false,\n          hoverConnectedEdges: false,\n          selectConnectedEdges: false,\n          zoomView: false\n        },\n        physics: {\n          enabled: true,\n          barnesHut: {\n            avoidOverlap: 1,\n            gravitationalConstant: -0.03,\n            centralGravity: 0,\n            springConstant: 0,\n            damping: 1,\n            springLength: 200\n          },\n          maxVelocity: 40\n\t\t},\n\t\tlocales: {\n\t\t\t'gtfs': {\n\t\t\t\tedit: 'Edit',\n\t\t\t\tdel: 'Delete selected',\n\t\t\t\tback: 'Back',\n\t\t\t\taddNode: 'Add Location',\n\t\t\t\taddEdge: 'Add Pathway',\n\t\t\t\teditNode: 'Edit Location',\n\t\t\t\teditEdge: 'Edit Pathway',\n\t\t\t\taddDescription: 'Click in an empty space to place a new location.',\n\t\t\t\tedgeDescription: 'Click on a location and drag the pathway to another location to connect them.',\n\t\t\t\teditEdgeDescription: 'Click on the control points and drag them to a location to connect to it.',\n\t\t\t\tcreateEdgeError: 'Cannot link pathways to a cluster.',\n\t\t\t\tdeleteClusterError: 'Clusters cannot be deleted.',\n\t\t\t\teditClusterError: 'Clusters cannot be edited.'\n\t\t\t}\n\t\t},\n\t\tlocale: 'gtfs'\n    };\n    let network = new vis.Network(container, {nodes, edges}, options);\n\n    network.on(\"doubleClick\", () => {\n      let selection = network.getSelection();\n      if (selection.nodes.length === 1) {\n        network.editNode();\n      }\n      else if (selection.edges.length === 1) {\n        network.editEdgeMode();\n      }\n    });\n  }\n\n  render() {\n    return (\n      <div id=\"vis\"></div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport './StopDialog.scss';\nimport Stop, { LocationTypeMap, WheelchairBoardingMap } from '../interfaces/Stop';\n\nexport interface StopDialogProps {\n  stop: Stop,\n  onCancel: () => void,\n  onApply: (stop: Stop) => void\n}\n\nexport interface StopDialogState {\n  stopName?: string,\n  locationType: number,\n  wheelchairBoarding: number,\n  platformCode?: string,\n  signpostedAs?: string\n}\n\nexport default class StopDialog extends Component<StopDialogProps, StopDialogState> {\n  constructor(props: StopDialogProps) {\n    super(props);\n    this.state = {\n      stopName: props.stop.stopName,\n      locationType: props.stop.locationType,\n      wheelchairBoarding: props.stop.wheelchairBoarding,\n      platformCode: props.stop.platformCode,\n      signpostedAs: props.stop.signpostedAs\n    }\n  }\n\n  private handleCancel = () => {\n    this.props.onCancel();\n  }\n\n  private handleApply = () => {\n    // Validate\n    if ([0, 1, 2].includes(this.state.locationType) && !this.state.stopName) {\n      alert('Selected location type must have a name');\n      return;\n    }\n\n    this.props.onApply({\n      ...this.props.stop, ...this.state\n    });\n  }\n\n  private handleLocationTypeChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    this.setState({\n      locationType: Number(event.target.value)\n    });\n  }\n\n  private handleWheelchairBoardingChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    this.setState({\n      wheelchairBoarding: Number(event.target.value)\n    });\n  }\n\n  private handleStopNameChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({\n      stopName: event.target.value\n    });\n  }\n\n  private handlePlatformCodeChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({\n      platformCode: event.target.value\n    });\n  }\n\n  private handleSignpostedAsChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({\n      signpostedAs: event.target.value\n    });\n  }\n\n  render() {\n    const locationTypeOptions: JSX.Element[] = [];\n    for (const locationType in LocationTypeMap) {\n      if (locationType === 'Station') {\n        continue;\n      }\n      locationTypeOptions.push(\n        <option key={locationType} value={LocationTypeMap[locationType]}>{locationType}</option>\n      );\n    }\n\n    const wheelchairBoardingOptions: JSX.Element[] = [];\n    for (const wheelchairBoardingKey in WheelchairBoardingMap) {\n      wheelchairBoardingOptions.push(\n        <option key={wheelchairBoardingKey} value={WheelchairBoardingMap[wheelchairBoardingKey]}>{wheelchairBoardingKey}</option>\n      );\n    }\n\n    return (\n      <div className=\"stop-dialog\">\n        <div className=\"header\">Location properties</div>\n        <div className=\"content\">\n          <div>\n            ID: {this.props.stop.stopId}\n          </div>\n          <div>\n            {[0, 2, 3, 4].includes(this.state.locationType) && <div> \n              Location type: \n              <select value={this.state.locationType} onChange={this.handleLocationTypeChange}>\n                {locationTypeOptions}\n              </select>\n            </div>}\n            <div>\n              Name: <input type=\"text\" value={this.state.stopName || \"\"} onChange={this.handleStopNameChange} />\n            </div>\n            {[0, 2].includes(this.state.locationType) && <div>\n              Platform code: <input type=\"text\" value={this.state.platformCode || \"\"} onChange={this.handlePlatformCodeChange} />\n            </div>}\n            {[0].includes(this.state.locationType) && <div>\n              Signposted as: <input type=\"text\" value={this.state.signpostedAs || \"\"} onChange={this.handleSignpostedAsChange} />\n            </div>}\n            {[0, 2].includes(this.state.locationType) && <div>\n              Wheelchair boarding: \n              <select value={this.state.wheelchairBoarding} onChange={this.handleWheelchairBoardingChange}>\n                {wheelchairBoardingOptions}\n              </select>\n            </div>}\n          </div>\n        </div>\n        <div className=\"footer\">\n          <button onClick={this.handleCancel}>Cancel</button>\n          <button onClick={this.handleApply}>Apply</button>\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport './PathwayDialog.scss';\nimport Pathway, { PathwayModeMap } from '../interfaces/Pathway';\n\nexport interface PathwayDialogProps {\n  pathway: Pathway,\n  onCancel: () => void,\n  onApply: (pathway: Pathway) => void\n}\n\nexport interface PathwayDialogState {\n  pathwayMode: number;\n  isBidirectional: boolean;\n  length?: string;\n  traversalTime?: number;\n  stairCount?: number;\n  maxSlope?: string;\n  minWidth?: string;\n  signpostedAs?: string;\n  reversedSignpostedAs?: string;\n}\n\nexport default class PathwayDialog extends Component<PathwayDialogProps, PathwayDialogState> {\n  constructor(props: PathwayDialogProps) {\n    super(props);\n    this.state = {\n      pathwayMode: props.pathway.pathwayMode,\n      isBidirectional: props.pathway.isBidirectional,\n      length: props.pathway.length ? props.pathway.length.toString() : undefined,\n      traversalTime: props.pathway.traversalTime,\n      stairCount: props.pathway.stairCount,\n      maxSlope: props.pathway.maxSlope ? props.pathway.maxSlope.toString() : undefined,\n      minWidth: props.pathway.minWidth ? props.pathway.minWidth.toString() : undefined,\n      signpostedAs: props.pathway.signpostedAs,\n      reversedSignpostedAs: props.pathway.reversedSignpostedAs\n    }\n  }\n\n  private handleCancel = () => {\n    this.props.onCancel();\n  }\n\n  private handleApply = () => {\n    this.props.onApply({\n      ...this.props.pathway,\n      ...this.state,\n      ...{\n        length: parseFloat(this.state.length || \"\"),\n        maxSlope: parseFloat(this.state.maxSlope || \"\"),\n        minWidth: parseFloat(this.state.minWidth || \"\")\n      }\n    });\n  }\n\n  private handlePathwayModeChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    this.setState({\n      pathwayMode: Number(event.target.value)\n    });\n  }\n\n  private handleIsBidirectionalChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({\n      isBidirectional: event.target.checked\n    });\n  }\n\n  private handleLengthChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({\n      length: event.target.value.replace(\",\", \".\").replace(/[^\\d.]/i, \"\")\n    });\n  }\n  \n  private handleTraversalTimeChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({\n      traversalTime: parseInt(event.target.value)\n    });\n  }\n\n  private handleStairCountChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({\n      stairCount: parseInt(event.target.value)\n    });\n  }\n\n  private handleMaxSlopeChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({\n      maxSlope: event.target.value.replace(\",\", \".\").replace(/[^\\d.]/i, \"\")\n    });\n  }\n\n  private handleMinWidthChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({\n      minWidth: event.target.value.replace(\",\", \".\").replace(/[^\\d.]/i, \"\")\n    });\n  }\n\n  private handleSignpostedAsChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({\n      signpostedAs: event.target.value\n    });\n  }\n\n  private handleReversedSignpostedAsChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({\n      reversedSignpostedAs: event.target.value\n    });\n  }\n\n  render() {\n    const pathwayModeOptions: JSX.Element[] = [];\n    for (const pathwayModeKey in PathwayModeMap) {\n      pathwayModeOptions.push(\n        <option key={pathwayModeKey} value={PathwayModeMap[pathwayModeKey]}>{pathwayModeKey}</option>\n      );\n    }\n\n    return (\n      <div className=\"pathway-dialog\">\n        <div className=\"header\">Pathway properties</div>\n        <div className=\"content\">\n        <div>\n            ID: {this.props.pathway.pathwayId}\n          </div>\n          <div>\n            <div> \n              Location type: \n              <select value={this.state.pathwayMode} onChange={this.handlePathwayModeChange}>\n                {pathwayModeOptions}\n              </select>\n            </div>\n            <div>\n              <label>\n                Is bidirectional: \n                <input type=\"checkbox\" checked={this.state.isBidirectional} onChange={this.handleIsBidirectionalChange} />\n              </label>\n            </div>\n            <div>\n              Length: <input type=\"text\" value={this.state.length || \"\"} onChange={this.handleLengthChange} /> meters\n            </div>\n            <div>\n              Traversal time: <input type=\"text\" value={this.state.traversalTime || \"\"} onChange={this.handleTraversalTimeChange} /> seconds\n            </div>\n            <div>\n              Stair count: <input type=\"text\" value={this.state.stairCount || \"\"} onChange={this.handleStairCountChange} />\n            </div>\n            <div>\n              Max slope: <input type=\"text\" value={this.state.maxSlope || \"\"} onChange={this.handleMaxSlopeChange} />\n            </div>\n            <div>\n              Min width: <input type=\"text\" value={this.state.minWidth || \"\"} onChange={this.handleMinWidthChange} /> meters\n            </div>\n            <div>\n              Signposted as: <input type=\"text\" value={this.state.signpostedAs || \"\"} onChange={this.handleSignpostedAsChange} />\n            </div>\n            <div>\n              Reversed signposted as: <input type=\"text\" value={this.state.reversedSignpostedAs || \"\"} onChange={this.handleReversedSignpostedAsChange} />\n            </div>\n          </div>\n        </div>\n        <div className=\"footer\">\n          <button onClick={this.handleCancel}>Cancel</button>\n          <button onClick={this.handleApply}>Apply</button>\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport './StationBuilder.scss';\nimport Vis from './Vis';\nimport StopDialog from './StopDialog';\nimport Stop from '../interfaces/Stop';\nimport VisNode from '../interfaces/VisNode';\nimport VisService from '../services/VisService';\nimport Communication from '../interfaces/Communication';\nimport Pathway from '../interfaces/Pathway';\nimport VisEdge from '../interfaces/VisEdge';\nimport PathwayDialog from './PathwayDialog';\nimport cloneDeep from 'lodash/cloneDeep';\n\nexport interface StationBuilderProps {\n\tdata: Communication,\n\tonSave: (data: Communication) => void\n}\n\nexport interface StationBuilderState {\n\tdata: Communication,\n\tselectedStop: {\n\t\tstop: Stop,\n\t\tnode: VisNode,\n\t\tcallback: (node?: VisNode) => void\n\t} | null,\n\tselectedPathway: {\n\t\tpathway: Pathway,\n\t\tedge: VisEdge,\n\t\tcallback: (edge?: VisEdge) => void\n\t} | null\n}\n\nexport default class StationBuilder extends Component<StationBuilderProps, StationBuilderState> {\n\tprivate stationId: number = -1;\n\n\tconstructor(props: StationBuilderProps) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tdata: cloneDeep(props.data),\n\t\t\tselectedStop: null,\n\t\t\tselectedPathway: null\n\t\t};\n\t\tthis.props.data.stops.map((stop: Stop) => {\n\t\t\tif (stop.locationType === 1) {\n\t\t\t\tthis.stationId = stop.stopId;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\tif (this.stationId === -1) {\n\t\t\tthrow new Error(\"No station provided in input data\");\n\t\t}\n\t}\n\n\tprivate handleStopAddMode = (node: VisNode, callback: (node?: VisNode) => void) => {\n\t\tnode = VisService.prepareNewNode(node);\n\t\tthis.setState({\n\t\t\tselectedStop: {\n\t\t\t\tstop: node.stop,\n\t\t\t\tnode: node,\n\t\t\t\tcallback: callback\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate handleStopEditMode = (node: VisNode, callback: (node?: VisNode) => void) => {\n\t\tthis.setState({\n\t\t\tselectedStop: {\n\t\t\t\tstop: node.stop,\n\t\t\t\tnode: node,\n\t\t\t\tcallback: callback\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate handlePathwayAddMode = (edge: VisEdge, callback: (edge?: VisEdge) => void) => {\n\t\tedge = VisService.prepareNewEdge(edge);\n\t\tthis.setState({\n\t\t\tselectedPathway: {\n\t\t\t\tpathway: edge.pathway,\n\t\t\t\tedge: edge,\n\t\t\t\tcallback: callback\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate handlePathwayEditMode = (edge: VisEdge, callback: (edge?: VisEdge) => void) => {\n\t\tthis.setState({\n\t\t\tselectedPathway: {\n\t\t\t\tpathway: edge.pathway,\n\t\t\t\tedge: edge,\n\t\t\t\tcallback: callback\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate handleStopDialogApply = (stop: Stop) => {\n\t\tif (this.state.selectedStop) {\n\t\t\tconst stopIndex = this.state.data.stops.findIndex(curStop => curStop.stopId === stop.stopId);\n\t\t\tif (stopIndex === -1) {\n\t\t\t\tthis.state.data.stops.push(stop);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.state.data.stops[stopIndex] = stop;\n\t\t\t}\n\t\t\tconst node = VisService.attachStopToNode(stop, this.state.selectedStop.node);\n\t\t\tthis.state.selectedStop.callback(node);\n\t\t\tthis.setState({\n\t\t\t\tselectedStop: null\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate handlePathwayDialogApply = (pathway: Pathway) => {\n\t\tif (this.state.selectedPathway) {\n\t\t\tconst pathwayIndex = this.state.data.pathways.findIndex(curPathway => curPathway.pathwayId === pathway.pathwayId);\n\t\t\tif (pathwayIndex === -1) {\n\t\t\t\tthis.state.data.pathways.push(pathway);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.state.data.pathways[pathwayIndex] = pathway;\n\t\t\t}\n\t\t\tconst edge = VisService.attachPathwayToEdge(pathway, this.state.selectedPathway.edge);\n\t\t\tthis.state.selectedPathway.callback(edge);\n\t\t\tthis.setState({\n\t\t\t\tselectedPathway: null\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate handleItemDelete = (\n\t\tdataToDelete: { nodes: number[], edges: number[] },\n\t\tcallback: (dataToDelete?: { nodes: number[], edges: number[] }) => void\n\t) => {\n\t\tdataToDelete.nodes.forEach((nodeId: number) => {\n\t\t\tif (this.stationId === nodeId) {\n\t\t\t\talert(\"It's disallowed to delete a station\");\n\t\t\t\tcallback();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconst stopIndex = this.state.data.stops.findIndex(stop => stop.stopId === nodeId);\n\t\t\t\tthis.state.data.stops.splice(stopIndex, 1);\n\t\t\t}\n\t\t});\n\t\tdataToDelete.edges.forEach((pathwayId: number) => {\n\t\t\tconst pathwayIndex = this.state.data.pathways.findIndex(pathway => pathway.pathwayId === pathwayId);\n\t\t\tthis.state.data.pathways.splice(pathwayIndex, 1);\n\t\t});\n\t\tcallback(dataToDelete);\n\t}\n\n\tprivate handleDialogCancel = () => {\n\t\tif (this.state.selectedStop) {\n\t\t\tthis.state.selectedStop.callback();\n\t\t\tthis.setState({\n\t\t\t\tselectedStop: null\n\t\t\t});\n\t\t}\n\t\tif (this.state.selectedPathway) {\n\t\t\tthis.state.selectedPathway.callback();\n\t\t\tthis.setState({\n\t\t\t\tselectedPathway: null\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate handleSaveClick = () => {\n\t\tthis.props.onSave(this.state.data);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"station-builder\">\n\t\t\t\t<div className=\"panel\">\n\t\t\t\t\t<button onClick={this.handleSaveClick}>Save</button>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"graph\">\n\t\t\t\t\t<Vis\n\t\t\t\t\t\tdata={this.state.data}\n\t\t\t\t\t\tonStopAdd={this.handleStopAddMode}\n\t\t\t\t\t\tonStopEdit={this.handleStopEditMode}\n\t\t\t\t\t\tonStopDelete={this.handleItemDelete}\n\t\t\t\t\t\tonPathwayAdd={this.handlePathwayAddMode}\n\t\t\t\t\t\tonPathwayEdit={this.handlePathwayEditMode}\n\t\t\t\t\t\tonPathwayDelete={this.handleItemDelete}></Vis>\n\n\t\t\t\t\t{this.state.selectedStop && <StopDialog\n\t\t\t\t\t\tstop={this.state.selectedStop.stop}\n\t\t\t\t\t\tonCancel={this.handleDialogCancel}\n\t\t\t\t\t\tonApply={this.handleStopDialogApply}></StopDialog>}\n\n\t\t\t\t\t{this.state.selectedPathway && <PathwayDialog\n\t\t\t\t\t\tpathway={this.state.selectedPathway.pathway}\n\t\t\t\t\t\tonCancel={this.handleDialogCancel}\n\t\t\t\t\t\tonApply={this.handlePathwayDialogApply}></PathwayDialog>}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import Stop from \"../interfaces/Stop\";\nimport Pathway from \"../interfaces/Pathway\";\nimport Level from \"../interfaces/Level\";\n\n/* GTFS to objects conversion and vise versa */\nexport default class DataService {\n    static fromGTFS<T>(data: string, recordFromGTFS: (record: {[key: string]: string}) => T): T[] {\n        const rows: string[] = data.split(\"\\n\");\n        let records: T[] = [];\n        let header: string[] = [];\n        rows.forEach((row: string) => {\n\t\t\tif (row) {\n\t\t\t\tconst cells = row.split(\",\");\n\t\t\t\t// header\n\t\t\t\tif (header.length === 0) {\n\t\t\t\t\tcells.forEach((cell: string, cellIndex: number) => {\n\t\t\t\t\t\theader[cellIndex] = cell;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// data\n\t\t\t\telse {\n\t\t\t\t\tlet recordGTFS: {[key: string]: string} = {};\n\t\t\t\t\tcells.forEach((cell: string, cellIndex: number) => {\n\t\t\t\t\t\tif (cell !== '') {\n\t\t\t\t\t\t\tconst fieldName = header[cellIndex];\n\t\t\t\t\t\t\trecordGTFS[fieldName] = cell;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\trecords.push(recordFromGTFS(recordGTFS));\n\t\t\t\t}\n\t\t\t}\n        });\n        return records;\n    }\n\n    static stopFromGTFS(stop: {[key: string]: string}): Stop {\n        return {\n            stopId: Number(stop['stop_id']),\n            stopName: stop['stop_name'],\n            locationType: Number(stop['location_type']),\n            wheelchairBoarding: Number(stop['wheelchair_boarding']),\n            levelId: Number(stop['level_id']),\n            platformCode: stop['platform_code'],\n            signpostedAs: stop['signposted_as']\n        };\n    }\n\n\tstatic getStopGTFSHeader(): string {\n\t\treturn\t'stop_id,' +\n\t\t\t\t'stop_name,' +\n\t\t\t\t'location_type,' +\n\t\t\t\t'wheelchair_boarding,' +\n\t\t\t\t'level_id,' +\n\t\t\t\t'platform_code,' +\n\t\t\t\t'signposted_as';\n\t}\n\n    static stopToGTFS(stop: Stop): string {\n        return  stop.stopId.toString() + ',' +\n\t\t\t\tthis.escapeText(stop.stopName || '') + ',' +\n                stop.locationType.toString() + ',' +\n                stop.wheelchairBoarding.toString() + ',' +\n                (stop.levelId || '') + ',' +\n                this.escapeText(stop.platformCode || '') + ',' +\n                this.escapeText(stop.signpostedAs || '');\n    }\n\n    static pathwayFromGTFS(pathway: {[key: string]: string}): Pathway {\n        return {\n            pathwayId: Number(pathway['pathway_id']),\n            fromStopId: Number(pathway['from_stop_id']),\n            toStopId: Number(pathway['to_stop_id']),\n            pathwayMode: Number(pathway['pathway_mode']),\n            isBidirectional: Number(pathway['is_bidirectional']) === 1,\n            length: Number(pathway['length']),\n            traversalTime: Number(pathway['traversal_time']),\n            stairCount: Number(pathway['stair_count']),\n            maxSlope: Number(pathway['max_slope']),\n            minWidth: Number(pathway['min_width']),\n            signpostedAs: pathway['signposted_as'],\n            reversedSignpostedAs: pathway['reversed_signposted_as']\n        };\n    }\n\n\tstatic getPathwayGTFSHeader(): string {\n\t\treturn\t'pathway_id,' +\n\t\t\t\t'from_stop_id,' +\n\t\t\t\t'to_stop_id,' +\n\t\t\t\t'pathway_mode,' +\n\t\t\t\t'is_bidirectional,' +\n\t\t\t\t'length,' +\n\t\t\t\t'traversal_time,' +\n\t\t\t\t'stair_count,' +\n\t\t\t\t'max_slope,' +\n\t\t\t\t'min_width,' +\n\t\t\t\t'signposted_as,' +\n\t\t\t\t'reversed_signposted_as';\n\t}\n\n    static pathwayToGTFS(pathway: Pathway): string {\n        return  pathway.pathwayId.toString() + ',' +\n                pathway.fromStopId.toString() + ',' +\n                pathway.toStopId.toString() + ',' +\n                pathway.pathwayMode.toString() + ',' +\n                (pathway.isBidirectional ? '1' : '0') + ',' +\n                (pathway.length || '') + ',' +\n                (pathway.traversalTime || '') + ',' +\n                (pathway.stairCount || '') + ',' +\n                (pathway.maxSlope || '') + ',' +\n                (pathway.minWidth || '') + ',' +\n                this.escapeText(pathway.signpostedAs || '') + ',' +\n                this.escapeText(pathway.reversedSignpostedAs || '');\n    }\n\n    static levelFromGTFS(level: {[key: string]: string}): Level {\n        return {\n            levelId: Number(level['level_id']),\n            levelName: level['level_name'],\n            levelIndex: Number(level['level_index'])\n        };\n    }\n\n\tstatic getLevelGTFSHeader(): string {\n\t\treturn\t'level_id,' +\n\t\t\t\t'level_name,' +\n\t\t\t\t'level_index';\n\t}\n\n    static levelToGTFS(level: Level): string {\n        return  level.levelId.toString() + ',' +\n\t\t\t\tthis.escapeText(level.levelName || '') + ',' +\n                level.levelIndex.toString();\n\t}\n\n\t// TODO\n\tstatic escapeText(text: string): string {\n\t\treturn text;\n\t}\n}\n","import React, { Component } from \"react\";\nimport \"./App.scss\";\nimport StationBuilder from \"./components/StationBuilder\";\nimport Communication from \"./interfaces/Communication\";\nimport DataService from \"./services/DataService\";\nimport Stop from \"./interfaces/Stop\";\nimport JSZip from 'jszip';\nimport { saveAs } from 'file-saver';\nimport Pathway from \"./interfaces/Pathway\";\nimport Level from \"./interfaces/Level\";\n\nexport interface AppProps {}\n\nexport interface AppState {\n\teditMode: boolean;\n\tdata: Communication;\n}\n\nexport default class App extends Component<AppProps, AppState> {\n\tpublic constructor(props: AppProps) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\teditMode: false,\n\t\t\tdata: {\n\t\t\t\tstops: [],\n\t\t\t\tpathways: [],\n\t\t\t\tlevels: []\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n\t\tif (event.target.files) {\n\t\t\tlet requiredFiles = [\"stops.txt\", \"pathways.txt\", \"levels.txt\"];\n\t\t\tlet requiredFilesCount = requiredFiles.length;\n\t\t\tlet communicationPacket: Communication = {\n\t\t\t\tstops: [],\n\t\t\t\tpathways: [],\n\t\t\t\tlevels: []\n\t\t\t};\n\t\t\t\n\t\t\t// Zip\n\t\t\tif (event.target.files.length === 1) {\n\t\t\t\tconst zipFile = event.target.files[0];\n\t\t\t\tJSZip.loadAsync(zipFile).then((zip) => {\n\t\t\t\t\tzip.forEach((relativePath, file) => {\n\t\t\t\t\t\trequiredFiles.splice(requiredFiles.indexOf(file.name), 1);\n\t\t\t\t\t\tfile.async(\"text\").then((fileContent: string) => {\n\t\t\t\t\t\t\tif (this.extractData(file.name, fileContent, communicationPacket)) {\n\t\t\t\t\t\t\t\trequiredFilesCount--;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (requiredFilesCount === 0) {\n\t\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\t\tdata: communicationPacket,\n\t\t\t\t\t\t\t\t\teditMode: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tif (requiredFiles.length !== 0) {\n\t\t\t\t\t\talert(\"Missing files: \" + requiredFiles.join(\", \"));\n\t\t\t\t\t}\n\t\t\t\t}, function (e) {\n\t\t\t\t\tconsole.log(e);\n\t\t\t\t\talert(e.message);\n\t\t\t\t});\n\t\t\t}\n\t\t\t// Separate files\n\t\t\telse {\n\t\t\t\tArray.from(event.target.files).forEach((file: File) => {\n\t\t\t\t\trequiredFiles.splice(requiredFiles.indexOf(file.name), 1);\n\t\t\t\t\tconst fileReader = new FileReader();\n\t\t\t\t\tfileReader.onload = () => {\n\t\t\t\t\t\tif (this.extractData(file.name, fileReader.result ? fileReader.result.toString() : \"\", communicationPacket)) {\n\t\t\t\t\t\t\trequiredFilesCount--;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (requiredFilesCount === 0) {\n\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\tdata: communicationPacket,\n\t\t\t\t\t\t\t\teditMode: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tfileReader.readAsText(file);\n\t\t\t\t});\n\t\t\t\tif (requiredFiles.length !== 0) {\n\t\t\t\t\talert(\"Missing files: \" + requiredFiles.join(\", \"));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tprivate extractData(fileName: string, data: string, communicationPacket: Communication): boolean {\n\t\tswitch (fileName) {\n\t\t\tcase \"stops.txt\":\n\t\t\t\tcommunicationPacket.stops = DataService.fromGTFS(\n\t\t\t\t\tdata,\n\t\t\t\t\tDataService.stopFromGTFS\n\t\t\t\t);\n\t\t\t\treturn true;\n\t\t\tcase \"pathways.txt\":\n\t\t\t\tcommunicationPacket.pathways = DataService.fromGTFS(\n\t\t\t\t\tdata,\n\t\t\t\t\tDataService.pathwayFromGTFS\n\t\t\t\t);\n\t\t\t\treturn true;\n\t\t\tcase \"levels.txt\":\n\t\t\t\tcommunicationPacket.levels = DataService.fromGTFS(\n\t\t\t\t\tdata,\n\t\t\t\t\tDataService.levelFromGTFS\n\t\t\t\t);\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate saveStation = (data: Communication) => {\n\t\tlet stopsTxt = DataService.getStopGTFSHeader() + \"\\n\";\n\t\tlet pathwaysTxt = DataService.getPathwayGTFSHeader() + \"\\n\";\n\t\tlet levelsTxt = DataService.getLevelGTFSHeader() + \"\\n\";\n\t\tdata.stops.forEach((stop: Stop) => {\n\t\t\tstopsTxt += DataService.stopToGTFS(stop) + \"\\n\";\n\t\t});\n\t\tdata.pathways.forEach((pathway: Pathway) => {\n\t\t\tpathwaysTxt += DataService.pathwayToGTFS(pathway) + \"\\n\";\n\t\t});\n\t\tdata.levels.forEach((level: Level) => {\n\t\t\tlevelsTxt += DataService.levelToGTFS(level) + \"\\n\";\n\t\t});\n\t\tconst zip = new JSZip();\n\t\tzip.file('stops.txt', stopsTxt);\n\t\tzip.file('pathways.txt', pathwaysTxt);\n\t\tzip.file('levels.txt', levelsTxt);\n\t\tzip.generateAsync({ type: \"blob\" }).then(function (blob) {\n\t\t\tsaveAs(blob, \"gtfs.zip\");\n\t\t});\n\t\tthis.setState({\n\t\t\teditMode: false,\n\t\t\tdata: {\n\t\t\t\tstops: [],\n\t\t\t\tpathways: [],\n\t\t\t\tlevels: []\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate loadSampleData = () => {\n\t\tlet communicationPacket: Communication = {\n\t\t\tstops: [],\n\t\t\tpathways: [],\n\t\t\tlevels: []\n\t\t};\n\t\tthis.extractData(\"stops.txt\",\n\t\t\t`stop_id,stop_name,location_type,parent_station,wheelchair_boarding,level_id,platform_code\n\t\t\t1,XYZ,1,,0,,\n\t\t\t2,1,0,1,1,2,K\n\t\t\t3,2,0,1,1,,\n\t\t\t4,Center,2,1,2,,\n\t\t\t5,Park,2,1,1,1,`\n\t\t, communicationPacket);\n\t\tthis.extractData(\"pathways.txt\",\n\t\t\t`pathway_id,from_stop_id,to_stop_id,pathway_mode,is_bidirectional,length,traversal_time,stair_count,max_slope,min_width,signposted_as,reversed_signposted_as\n\t\t\t1,4,2,4,1,,60,,,,,\n\t\t\t2,4,2,2,1,,120,,,,,\n\t\t\t3,5,2,5,1,,20,,,,,\n\t\t\t4,2,3,1,1,,30,,,,,`\n\t\t, communicationPacket);\n\t\tthis.extractData(\"levels.txt\",\n\t\t\t`level_id,level_index,level_name\n\t\t\t1,0,\n\t\t\t2,-1,`\n\t\t, communicationPacket);\n\t\tthis.setState({\n\t\t\tdata: communicationPacket,\n\t\t\teditMode: true\n\t\t});\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"container\">\n\t\t\t\t{!this.state.editMode && (\n\t\t\t\t\t<div className=\"controls\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\tSelect stops.txt, pathways.txt and levels.txt (you can also select a .zip containing those files):\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\tmultiple={true}\n\t\t\t\t\t\t\tonChange={this.handleFileChange}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<div>OR</div>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<button onClick={this.loadSampleData}>LOAD SAMPLE DATA</button>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t{this.state.editMode && (\n\t\t\t\t\t<StationBuilder data={this.state.data} onSave={this.saveStation}></StationBuilder>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4wgODi84vCtShwAAAMVJREFUSMftlbENwjAUREPKdLAFtEyRiFBSwgaho6Uge8Ak3oIVMgAiBdWjOYkPMorskAIpJ30pts/35G9LSZJRfyEgBxpVPgSg4aUmZG8awZsMcYLCnKAY6h4ACN2XdoSWgPOBYmCf4bUNwqM+4StlPICqT4u+AZzy9r7WGF2BLAZwU8CsAwBw/gnA41kArXzb3i0yawfgpO+dfC0wDwGU9pKBqarSHMBS3ovGx+hn6lFtfBmwiX1Na7XrrnJAOf5fRr3pCeqXbYu/ZJnBAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4wgODwAgvJmYiwAAAOZJREFUSMftlDEOgjAUhltGNr2Frp4CIquj3gA3Vwe5h56kt/AKHMDI4PS5PGJDGmlpWYx/0oTS9nt//sJT6q+BAOy5nguutdZKKZV5HiyAVkbhCw9x1vJR64L3Gq5lE5LQyZxbkNIyWfo4D77kHtK79HWejUArwLjyThFLY8NwKOZ73grjBdSuArE/jBHO0XWhlu5APqXAQwDLkQIA1+gCrmiANdDJ6/3kiIZw4ARc5PkgSx2wCilQOaJYALVcPMBG9t5kfg7ujF/UWPtyYBcDN8BThgGqyY0rWfOatTP69KJU8N/QG1gTxBTCzhI8AAAAAElFTkSuQmCC\""],"sourceRoot":""}